Overview

This document describes every validation rule implemented in the SQL Validator engine.

Each rule includes:
- Purpose
- Exact logic
- Success conditions
- Failure conditions
- Edge cases
- Examples

These rules apply to Oracle-style SQL & PL/SQL.

1Ô∏è‚É£ DML Commit Rule

File: validator/rules/dml_commit.py
Rule ID: dml_commit

‚úÖ Purpose
Ensure that all DML statements explicitly commit their changes.

üîç What it checks
The following statements must be followed by a COMMIT:
- INSERT
- UPDATE
- DELETE

‚úî PASS Examples
DELETE FROM emp WHERE id=1;
COMMIT;

‚ùå FAIL Examples
UPDATE emp SET salary=5000 WHERE id=1;
-- missing COMMIT

2Ô∏è‚É£ DDL No-Commit Rule

File: validator/rules/ddl_no_commit.py
Rule ID: ddl_no_commit

‚úÖ Purpose
Oracle auto-commits DDL. Explicit COMMIT after DDL is unnecessary and restricted.

üîç What it checks
The following must NOT be followed by a COMMIT:
- CREATE
- ALTER
- DROP
- TRUNCATE

‚úî PASS Examples
CREATE TABLE emp (id NUMBER);

‚ùå FAIL Examples
CREATE TABLE emp (id NUMBER);
COMMIT;

3Ô∏è‚É£ GRANT / REVOKE No-Commit Rule

File: validator/rules/grant_revoke_no_commit.py
Rule ID: grant_revoke_no_commit

‚úÖ Purpose
Privilege changes must not be followed by explicit COMMIT.

‚úî PASS
GRANT SELECT ON emp TO hr;

‚ùå FAIL
GRANT SELECT ON emp TO hr;
COMMIT;

4Ô∏è‚É£ PL/SQL Slash Rule (Strict Mode)

File: validator/rules/plsql_slash.py
Rule ID: plsql_slash

‚úÖ Purpose
All Oracle PL/SQL blocks must end with / on a new line.

‚úî PASS
BEGIN
  NULL;
END;
/

‚ùå FAIL
BEGIN
  NULL;
END;
-- MISSING slash

5Ô∏è‚É£ Object Name Length Rule

File: validator/rules/object_name_length_rule.py
Rule ID: object_name_length

‚úÖ Purpose
Enforce Oracle‚Äôs ‚â§ 30-character identifier limit.

üîç What it checks
Extracts object name (ignoring schema prefix) and validates length ‚â§ 30.

‚úî PASS
CREATE TABLE hr.shortname (id NUMBER);

‚ùå FAIL
CREATE TABLE hr.this_is_a_very_long_table_name_exceeding_limit (id NUMBER);

6Ô∏è‚É£ Backup Table Rules
File: validator/rules/backup_table_rule.py
Rule ID: backup_table_suffix

‚úÖ Purpose
Ensure backup tables follow strict naming and storage policies.

üîç What it checks
1. Suffix: Must end with _TBD
2. Tablespace: Must be created in a backup tablespace (e.g., BACKUP_TBS)
3. Lifecycle: Issues warning to drop after usage.
4. Identification: Applies to tables starting with BACKUP_ or containing _BACKUP / _BKP.

‚úî PASS
CREATE TABLE hr.backup_data_TBD (id NUMBER) TABLESPACE BACKUP_TBS;

‚ùå FAIL
CREATE TABLE hr.backup_data (id NUMBER);         -- Missing _TBD
CREATE TABLE hr.backup_data_TBD (id NUMBER);     -- Missing Tablespace
CREATE TABLE hr.backup_data_TBD (id NUMBER) TABLESPACE USERS; -- Wrong Tablespace

7Ô∏è‚É£ Table Naming Convention Rule

File: validator/rules/table_naming_convention_rule.py
Rule ID: table_naming_convention

‚úÖ Purpose
Enforce strict naming conventions for ALL tables.

üîç What it checks
- Must start with a letter
- No special characters (hyphens, brackets)
- No quotes
- Only alphanumeric and underscores

‚úî PASS
CREATE TABLE hr.employees (id NUMBER);

‚ùå FAIL
CREATE TABLE hr."employees" (id NUMBER);  -- Quoted
CREATE TABLE hr.1emp (id NUMBER);         -- Starts with number
CREATE TABLE hr.emp-1 (id NUMBER);        -- Special char

8Ô∏è‚É£ Schema Validation Rule (Prefix & Consistency)
File: validator/rules/schema_validation_rule.py
Rule ID: schema_validation

‚úÖ Purpose
Unified rule to enforce schema usage.

üîç What it checks
1. Prefix: DDL & DML (INSERT, UPDATE, DELETE) must have schema prefix (e.g., schema.table).
2. Consistency: All statements in a file must belong to the same schema.
3. No Quotes: Schema/Object names must not be quoted.

‚úî PASS
CREATE TABLE hr.emp (id NUMBER);
INSERT INTO hr.emp VALUES (1);

‚ùå FAIL
CREATE TABLE emp (id NUMBER);     -- Missing prefix
INSERT INTO emp VALUES (1);       -- Missing prefix
CREATE TABLE "hr".emp ...         -- Quoted schema

Consistency Fail:
CREATE TABLE hr.t1 ...
CREATE TABLE finance.t2 ...       -- Mixed schemas in one file

9Ô∏è‚É£ Backup Table Grant Restriction

File: validator/rules/backup_grant_rule.py
Rule ID: backup_grant_select

‚úÖ Purpose
Restrict usage of backup tables. Only LOADER user can SELECT from them.

‚úî PASS
GRANT SELECT ON hr.emp_bkp_tbd TO LOADER;

‚ùå FAIL
GRANT SELECT ON hr.emp_bkp_tbd TO APP_USER;

üîü GRANT ALL Restriction

File: validator/rules/grant_all_rule.py
Rule ID: grant_all_restriction

‚úÖ Purpose
Prevent excessive privileges. GRANT ALL is forbidden.

‚ùå FAIL
GRANT ALL ON hr.emp TO user;

1Ô∏è‚É£1Ô∏è‚É£ Grant Privilege Restriction

File: validator/rules/grant_privilege_rule.py
Rule ID: grant_privilege_restriction

‚úÖ Purpose
Restrict privileges for regular users.
- Regular users: Only SELECT allowed
- LOADER: Any privilege allowed

‚úî PASS
GRANT SELECT ON hr.emp TO app_user;
GRANT INSERT ON hr.emp TO LOADER;

‚ùå FAIL
GRANT INSERT ON hr.emp TO app_user;

1Ô∏è‚É£2Ô∏è‚É£ Backup Table Drop Limit

File: validator/rules/backup_drop_limit_rule.py
Rule ID: backup_drop_limit

‚úÖ Purpose
Limit accidental mass deletion of backup tables (safety).
Max 400 _TBD drops per file.

‚ùå FAIL
File containing > 400 DROP TABLE ... _TBD statements.

1Ô∏è‚É£3Ô∏è‚É£ NOLOGGING Restriction

File: validator/rules/nologging_rule.py
Rule ID: nologging_restriction

‚úÖ Purpose
Ensure recoverability. Objects must not use NOLOGGING mode.

‚úî PASS
CREATE TABLE hr.emp (id NUMBER);

‚ùå FAIL
CREATE TABLE hr.emp (id NUMBER) NOLOGGING;

1Ô∏è‚É£4Ô∏è‚É£ Semicolon Requirement Rule

File: validator/rules/semicolon_rule.py
Rule ID: semicolon_required

‚úÖ Purpose
Ensure SQL statements terminate properly.

‚úî PASS
DELETE FROM emp WHERE id=1;

‚ùå FAIL
DELETE FROM emp WHERE id=1

1Ô∏è‚É£5Ô∏è‚É£ Tablespace Restriction Rule
File: validator/rules/tablespace_restriction_rule.py
Rule ID: tablespace_restriction

‚úÖ Purpose
Prevent object creation in system or default tablespaces.

üîç What it checks
Objects cannot be created in:
- USERS
- SYSTEM
- SYSAUX
- TEMP
- DEFAULT

‚úî PASS
CREATE TABLE hr.t1 (id NUMBER) TABLESPACE DATA_TBS;

‚ùå FAIL
CREATE TABLE hr.t1 (id NUMBER) TABLESPACE USERS;
CREATE TABLE hr.t1 (id NUMBER) TABLESPACE SYSTEM;